#include <iostream>
using namespace std;

//*

int main()
{
    long long N;
    cin>>N;

    long long M = 1000000007;
    N++;
    //  [d][v<N][v carry]
    long long T[64][2][2] = {};

    if ((N&1)==0)
    {
        T[0][0][0] = 2;
        T[0][0][1] = 1;
    }
    else
    {
        T[0][0][0] = 1;
        T[0][1][0] = 1;
        T[0][1][1] = 1;
    }

    for (int i=1; i<64; i++)
    {
        if ((N>>i&1)==0)
        {
            T[i][0][0] = (T[i-1][0][0]*2 + T[i-1][0][1] + T[i-1][1][0] + T[i-1][1][1])%M;
            T[i][0][1] = (T[i-1][0][0] + T[i-1][0][1]*2 + T[i-1][1][1])%M;
            T[i][1][0] = (T[i-1][1][0])%M;
            T[i][1][1] = (T[i-1][1][0] + T[i-1][1][1])%M;
        }
        else
        {
            T[i][0][0] = (T[i-1][0][0] + T[i-1][0][1])%M;
            T[i][0][1] = (T[i-1][0][1])%M;
            T[i][1][0] = (T[i-1][0][0] + 2*T[i-1][1][0] + T[i-1][1][1])%M;
            T[i][1][1] = (T[i-1][0][0] + T[i-1][0][1] + T[i-1][1][0] + 2*T[i-1][1][1])%M;
        }
    }
    cout<<T[63][1][0]<<endl;
}
